/*
 * File: app/view/slBsc2400ViewController.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.6.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.6.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('hkCRM.view.slbsc.slBsc2400ViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.slbsc2400',
    
    init: function(){ 
    	
    	var frm = this;
    	
    	Ext.Ajax.request( {   //업무구분과 코드구분 콤보 조회
            url: '/api/Adm/getAdm1001',
            method: 'POST',
            headers: {
                'Content-Type': 'application/json', 
            },  
            jsonData: {
            	jobclsf: '10',
	            cdclsf: '820',
                loginID:loginID,
				sessionkey: sessionkey
            },
            success: function ( response, opts )
            { 
            	 var obj = Ext.decode( response.responseText ); 
                if ( obj.status == 'true' )
                {    
                    var obj = Ext.decode( response.responseText ); 
                  
                   	frm.lookupReference('cdcls').getStore().loadData(obj.curlist);    
                   	frm.lookupReference('D_GIIDCLSFNM').getStore().loadData(obj.curlist);    
                }
                else
                {
                    Ext.Msg.alert( 'Failed', obj.errmsg, function () { return false; } );
                }
            },

            failure: function ( response, opts )
            {
                Ext.Msg.alert( 'System Error', response.status, function () { return false; } );
            }
        } );
    	
    },
    
    
    buttonClick: function(xtypeNm, titleNm )
    {

    	var frm = this;
    	var p_guidclsfcd  = this.lookupReference('cdcls').getValue();
    	var p_guidwrtgcd  = this.lookupReference('codecls').getValue();
    	
    	if (titleNm == "조회")
    	{
        	
        	this.lookupReference('D_GUIDWRTGCD').setValue('');
        	this.lookupReference('D_DESCRI').setValue('');
        	this.lookupReference('D_LINE1').setValue('');
        	this.lookupReference('D_LINE2').setValue('');
        	this.lookupReference('D_LINE3').setValue('');
        	this.lookupReference('D_LINE4').setValue('');
        	this.lookupReference('D_LINE5').setValue('');
        	this.lookupReference('D_LINE6').setValue('');
        	this.lookupReference('D_LINE7').setValue('');
        	this.lookupReference('D_LINE8').setValue('');
        	this.lookupReference('D_LINE9').setValue('');
        	this.lookupReference('D_LINE10').setValue('');
        	this.lookupReference('D_LINE11').setValue('');
        	this.lookupReference('D_LINE12').setValue('');
        	this.lookupReference('D_LINE13').setValue('');
        	
        	
        	Ext.Ajax.request( {   //안내문 목록 조회
                url: '/api/bsc/getBsc2401',
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json', 
                },  
                jsonData: {
                	bocd: '99999',
                	guidclsfcd: p_guidclsfcd,
                	guidwrtgcd: p_guidwrtgcd,
                	pageno: 0,
                	pagesize: 0,
                    loginID:loginID,
    				sessionkey: sessionkey
                },
                success: function ( response, opts )
                { 
                	 var obj = Ext.decode( response.responseText ); 
                    if ( obj.status == 'true' )
                    {    
                        var obj = Ext.decode( response.responseText ); 
                       	frm.lookupReference('curlist').getStore().loadData(obj.curlist);    
                       	frm.lookupReference('curlist').setTitle ('총건수 : ' + obj.totalcnt);
                        Ext.Msg.alert( 'Success', '조회가 완료되었습니다.', function () { return true; } );
                    }
                    else
                    {
                        Ext.Msg.alert( 'Failed', obj.errmsg, function () { return false; } );
                    }
                },

                failure: function ( response, opts )
                {
                    Ext.Msg.alert( 'System Error', response.status, function () { return false; } );
                }
            } );    		
    	}
    	else if  (titleNm == "신규")
    	{
        	this.lookupReference('D_GUIDWRTGCD').setValue('');
        	this.lookupReference('D_DESCRI').setValue('');
        	this.lookupReference('D_LINE1').setValue('');
        	this.lookupReference('D_LINE2').setValue('');
        	this.lookupReference('D_LINE3').setValue('');
        	this.lookupReference('D_LINE4').setValue('');
        	this.lookupReference('D_LINE5').setValue('');
        	this.lookupReference('D_LINE6').setValue('');
        	this.lookupReference('D_LINE7').setValue('');
        	this.lookupReference('D_LINE8').setValue('');
        	this.lookupReference('D_LINE9').setValue('');
        	this.lookupReference('D_LINE10').setValue('');
        	this.lookupReference('D_LINE11').setValue('');
        	this.lookupReference('D_LINE12').setValue('');
        	this.lookupReference('D_LINE13').setValue('');
    	}
    	else 
    	{
    		var D_MODE = this.lookupReference('D_GUIDWRTGCD').getValue();
    		var D_BOCD = '99999'; 
    		var D_GUIDCLSFCD = this.lookupReference('D_GIIDCLSFNM').getValue();
    		var D_GUIDWRTGCD = this.lookupReference('D_GUIDWRTGCD').getValue();
    		var D_DESCRI = this.lookupReference('D_DESCRI').getValue();
    		var D_LINE1 = this.lookupReference('D_LINE1').getValue();
    		var D_LINE2 = this.lookupReference('D_LINE2').getValue();
    		var D_LINE3 = this.lookupReference('D_LINE3').getValue();
    		var D_LINE4 = this.lookupReference('D_LINE4').getValue();
    		var D_LINE5 = this.lookupReference('D_LINE5').getValue();
    		var D_LINE6 = this.lookupReference('D_LINE6').getValue();
    		var D_LINE7 = this.lookupReference('D_LINE7').getValue();
    		var D_LINE8 = this.lookupReference('D_LINE8').getValue();
    		var D_LINE9 = this.lookupReference('D_LINE9').getValue();
    		var D_LINE10 = this.lookupReference('D_LINE10').getValue();
    		var D_LINE11 = this.lookupReference('D_LINE11').getValue();
    		var D_LINE12 = this.lookupReference('D_LINE12').getValue();
    		var D_LINE13 = this.lookupReference('D_LINE13').getValue();
    		var D_INCMGPERS = loginID;
    		
    		if  (titleNm == "삭제")
			{
    			D_MODE = 'D';			
			}
    		else
			{
        		if ( D_MODE == "")
    			{
        			D_MODE = 'I';
    			}
        		else
    			{
        			D_MODE = 'U';
    			}
			
			}
    		
        	Ext.Ajax.request( {   //안내문구분 콤보 조회
                url: '/api/bsc/getBsc2410',
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json', 
                },  
                jsonData: {
                	mode: D_MODE, 
                	bocd: '99999',
                	guidclsfcd: D_GUIDCLSFCD,
                	guidwrtgcd: D_GUIDWRTGCD,
                	descri: D_DESCRI,
                	line1: D_LINE1,
                	line2: D_LINE2,
                	line3: D_LINE3,
                	line4: D_LINE4,
                	line5: D_LINE5,
                	line6: D_LINE6,
                	line7: D_LINE7,
                	line8: D_LINE8,
                	line9: D_LINE9,
                	line10: D_LINE10,
                	line11: D_LINE11,
                	line12: D_LINE12,
                	line13: D_LINE13,
                	incmgpers: loginID,                    
                	loginID:loginID,
    				sessionkey: sessionkey
                },
                success: function ( response, opts )
                { 
                	var obj = Ext.decode( response.responseText ); 
                    if ( obj.status == 'true' )
                    {    
                        var obj = Ext.decode( response.responseText ); 
                        frm.getView().getController().buttonClick("aa","조회");
                        Ext.Msg.alert( 'Success', '수정이 완료되었습니다.', function () { return true; } );
                    }
                    else
                    {
                        Ext.Msg.alert( 'Failed', obj.errmsg, function () { return false; } );
                    }
                },

                failure: function ( response, opts )
                {
                    Ext.Msg.alert( 'System Error', response.status, function () { return false; } );
                }
            } );    
        	


        	
        	
        	
        	 
          // frm.lookupReference('curlist').title = "총건수 : " + store.getCount();
             
        	
        	
    	}
    	


    },
    
    onItemClick: function(grid,record,item,index,e,eOpts)
    {
    	var details_panel = this.lookupReference('details');
    	
    	this.lookupReference('D_GIIDCLSFNM').setValue(record.data.GUIDCLSFCD);
    	this.lookupReference('D_GUIDWRTGCD').setValue(record.data.GUIDWRTGCD);
    	this.lookupReference('D_DESCRI').setValue(record.data.DESCRI);
    	this.lookupReference('D_LINE1').setValue(record.data.LINE1);
    	this.lookupReference('D_LINE2').setValue(record.data.LINE2);
    	this.lookupReference('D_LINE3').setValue(record.data.LINE3);
    	this.lookupReference('D_LINE4').setValue(record.data.LINE4);
    	this.lookupReference('D_LINE5').setValue(record.data.LINE5);
    	this.lookupReference('D_LINE6').setValue(record.data.LINE6);
    	this.lookupReference('D_LINE7').setValue(record.data.LINE7);
    	this.lookupReference('D_LINE8').setValue(record.data.LINE8);
    	this.lookupReference('D_LINE9').setValue(record.data.LINE9);
    	this.lookupReference('D_LINE10').setValue(record.data.LINE10);
    	this.lookupReference('D_LINE11').setValue(record.data.LINE11);
    	this.lookupReference('D_LINE12').setValue(record.data.LINE12);
    	this.lookupReference('D_LINE13').setValue(record.data.LINE13);
    }
    
    
    
});
